# Telegram Patrol Bot

Бот для управления списком стажёров и организации патрулей в Telegram-чате.

---

## Описание

Данный бот помогает автоматизировать процесс ведения списка стажёров и координацию патрулей. Он позволяет:

- Добавлять и удалять стажёров вручную и автоматически при вступлении или выходе из чата  
- Запускать запись участников на патруль и завершать её с подтверждением присутствия  
- Автоматически сохранять данные в JSON-файл для сохранения состояния между сессиями  
- Контролировать доступ к административным функциям с помощью списка доверенных пользователей  
- Настраивать кодовые фразы для управления ботом  

---

## Функционал

- **Управление стажёрами:**  
  - Автоматическое добавление новых участников в список стажёров  
  - Ручное добавление и удаление стажёров через команды  
  - Просмотр текущего списка стажёров  

- **Патрулирование:**  
  - Запуск записи на патруль командой  
  - Участники записываются в патруль с помощью ключевой фразы  
  - Завершение записи и отправка сообщения с участниками патруля  
  - Подтверждение присутствия участников с учётом исключений  
  - Автоматическое обновление списка стажёров по результатам патруля  

- **Настройка:**  
  - Возможность менять кодовые фразы для команд через специальную команду  
  - Хранение и загрузка данных из файла `data.json`  

- **Контроль доступа:**  
  - Только доверенные пользователи могут выполнять команды управления стажёрами и патрулями  

---

## Использование

### Основные команды и кодовые фразы

| Команда / Фраза               | Описание                                      |
|------------------------------|-----------------------------------------------|
| `зарегистрировать патруль`    | Начать запись участников на патруль           |
| `я готов патрулировать`       | Записаться на текущий патруль                  |
| `закончить патруль`           | Завершить запись и запросить подтверждение    |
| `список стажеров`             | Вывести текущий список стажёров                |
| `список патруля`              | Показать текущих записавшихся на патруль       |

### Административные команды (только для доверенных пользователей)

- `/add_intern @username` — добавить стажёра вручную  
- `/remove_intern @username` — удалить стажёра вручную  
- `/set_phrase <команда> <новая фраза>` — изменить кодовую фразу для управления ботом  

---

### Логика работы патруля

1. **Запуск записи на патруль**:  
   Отправьте фразу `зарегистрировать патруль`, чтобы начать сбор заявок. Список участников очищается.

2. **Запись на патруль**:  
   Участники отправляют `я готов патрулировать`, чтобы записаться в патруль.

3. **Завершение записи**:  
   Отправьте `закончить патруль`. Бот покажет список записавшихся и спросит, все ли пришли.

4. **Подтверждение присутствия**:  
   Ответьте на сообщение бота одним из вариантов:  
   - `да` — все участники пришли  
   - `да кроме @username1 @username2` — все, кроме указанных, пришли  
   - `нет` — никто не пришёл  
   - `нет кроме @username1 @username2` — только указанные пришли

5. **Обновление списка стажёров**:  
   Пришедшие участники автоматически удаляются из списка стажёров.

---

## Примечания

- Все данные сохраняются в файле `data.json` для постоянства состояния.  
- Контроль доступа осуществляется по списку ID доверенных пользователей, заданному в коде.  
- Можно изменять кодовые фразы под свои нужды с помощью команды `/set_phrase`.

---


